---
export interface Props {
	story: {
		sectionTitle: string;
		heading: string;
		paragraphs: string[];
		button: string;
		testimonial?: string;
		testimonialAuthor?: string;
		testimonialRole?: string;
		recommendationsTitle?: string;
		recommendations?: { quote: string; author: string; role: string }[];
	};
	calendlyUrl: string;
	showRecommendations?: boolean;
}

const { story, calendlyUrl, showRecommendations = true } = Astro.props;
---

<section class="story">
	<div class="container story-grid">
		<div>
			<p class="section-title">{story.sectionTitle}</p>
			<h2>{story.heading}</h2>
			{story.paragraphs.map((paragraph) => (
				<p>{paragraph}</p>
			))}
			<a class="button primary" href={calendlyUrl} target="_blank" rel="noreferrer">{story.button}</a>
		</div>
		{showRecommendations && story.recommendations && story.recommendations.length ? (
			<div class="accent-box rec-banner" aria-label={story.recommendationsTitle ?? 'Recommendations'}>
				<p class="banner-title">{story.recommendationsTitle ?? 'Recommendations'}</p>
				<div class="rec-list">
					{story.recommendations.map((rec) => (
						<article class="rec-pill">
							<p class="testimonial">{rec.quote}</p>
							<p class="testimonial-author">
								<strong>{rec.author}</strong><br />
								{rec.role}
							</p>
						</article>
					))}
				</div>
			</div>
		) : null}
	</div>
</section>

<style>
	.story {
		background: linear-gradient(180deg, #fdfcf8 0%, #f6f1e6 100%);
	}

	.story-grid {
		display: grid;
		grid-template-columns: 1fr;
		gap: 1.75rem;
		align-items: start;
	}

	.accent-box {
		background: #eaffe0;
		border-radius: 2rem;
		padding: clamp(2rem, 4vw, 3.5rem);
		box-shadow: 0 40px 80px rgba(11, 49, 34, 0.08);
	}

	.rec-banner {
		display: grid;
		gap: 1rem;
		background: linear-gradient(135deg, #e4f6e4 0%, #f8fff8 100%);
	}

	.banner-title {
		margin: 0;
		font-weight: 700;
		color: var(--color-deep-green);
		text-transform: uppercase;
		letter-spacing: 0.05em;
		font-size: 0.95rem;
	}

	.rec-list {
		display: grid;
		grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
		gap: 1rem;
	}

	.rec-pill {
		border: 1px solid rgba(6, 24, 12, 0.08);
		border-radius: 1rem;
		background: #fff;
		padding: 1rem;
		box-shadow: 0 14px 32px rgba(6, 24, 12, 0.08);
		display: grid;
		gap: 0.6rem;
	}

	.testimonial {
		font-size: 1.1rem;
		font-weight: 500;
		line-height: 1.6;
	}

	.testimonial-author {
		margin-top: 1rem;
		color: var(--color-muted);
	}
</style>
